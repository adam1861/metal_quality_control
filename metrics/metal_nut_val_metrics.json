{
  "split": "val",
  "weights_path": "models\\best_unet_metalnut_multiclass.pth",
  "data_dir": "data\\processed\\metal_nut",
  "image_size": 256,
  "device": "cpu",
  "all_pixels": {
    "summary": {
      "pixel_accuracy": 0.9891095842633929,
      "mean_iou_all": 0.6183190593107036,
      "mean_iou_no_background": 0.5253136529128003,
      "macro_f1_no_background": 0.6064141821978217,
      "macro_precision_no_background": 0.608556213054458,
      "macro_recall_no_background": 0.6054162477675604,
      "defect_binary_precision": 0.9785420442251638,
      "defect_binary_recall": 0.941597321221364,
      "defect_binary_f1": 0.9597142625432526,
      "defect_binary_iou": 0.9225487075209999,
      "defect_binary_dice": 0.9597142625432526
    },
    "per_class": [
      {
        "class_id": 0,
        "class_name": "background",
        "support": 1225441,
        "precision": 0.9928456261904666,
        "recall": 0.9974588739890374,
        "f1": 0.995146903657774,
        "iou": 0.9903406849023171,
        "dice": 0.995146903657774,
        "specificity": 0.941597321221364
      },
      {
        "class_id": 1,
        "class_name": "bent",
        "support": 5920,
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "iou": 0.0,
        "dice": 0.0,
        "specificity": 1.0
      },
      {
        "class_id": 2,
        "class_name": "color",
        "support": 5606,
        "precision": 0.6921919411469654,
        "recall": 0.7384944702104888,
        "f1": 0.7145939414861484,
        "iou": 0.5559285618369814,
        "dice": 0.7145939414861483,
        "specificity": 0.9986568416444752
      },
      {
        "class_id": 3,
        "class_name": "flip",
        "support": 126736,
        "precision": 0.9880806008254301,
        "recall": 0.9955261330640071,
        "f1": 0.9917893934212957,
        "iou": 0.9837125169580065,
        "dice": 0.9917893934212957,
        "specificity": 0.9987819322619886
      },
      {
        "class_id": 4,
        "class_name": "scratch",
        "support": 12553,
        "precision": 0.7539523102454363,
        "recall": 0.687644387795746,
        "f1": 0.7192733938838429,
        "iou": 0.5616135328562134,
        "dice": 0.719273393883843,
        "specificity": 0.9979343009438272
      }
    ],
    "image_level_any_defect": {
      "num_images": 21,
      "tp": 17,
      "fp": 0,
      "fn": 0,
      "tn": 4,
      "accuracy": 1.0,
      "precision": 1.0,
      "recall": 1.0,
      "f1": 1.0
    },
    "confusion_matrix": [
      [
        1222327,
        0,
        654,
        1522,
        938
      ],
      [
        3760,
        0,
        1169,
        0,
        991
      ],
      [
        578,
        0,
        4140,
        0,
        888
      ],
      [
        567,
        0,
        0,
        126169,
        0
      ],
      [
        3903,
        0,
        18,
        0,
        8632
      ]
    ],
    "confusion_matrix_normalized_by_true": [
      [
        0.9974588739890374,
        0.0,
        0.0005336854242676718,
        0.0012420018589226246,
        0.0007654387277722877
      ],
      [
        0.6351351351351351,
        0.0,
        0.1974662162162162,
        0.0,
        0.16739864864864865
      ],
      [
        0.10310381733856583,
        0.0,
        0.7384944702104888,
        0.0,
        0.15840171245094542
      ],
      [
        0.00447386693599293,
        0.0,
        0.0,
        0.9955261330640071,
        0.0
      ],
      [
        0.31092169202581055,
        0.0,
        0.0014339201784434,
        0.0,
        0.687644387795746
      ]
    ],
    "total_pixels": 1376256
  },
  "nut_pixels_only": {
    "summary": {
      "pixel_accuracy": 0.9850048332940522,
      "mean_iou_all": 0.6573380280303981,
      "mean_iou_no_background": 0.5758289526814423,
      "macro_f1_no_background": 0.6441209015105057,
      "macro_precision_no_background": 0.6692671765819203,
      "macro_recall_no_background": 0.6222364898062214,
      "defect_binary_precision": 0.9912625982064915,
      "defect_binary_recall": 0.9501239864299514,
      "defect_binary_f1": 0.9702574220509873,
      "defect_binary_iou": 0.9422329840759767,
      "defect_binary_dice": 0.9702574220509873
    },
    "per_class": [
      {
        "class_id": 0,
        "class_name": "background",
        "support": 454056,
        "precision": 0.9857305141106217,
        "recall": 0.9975751889634759,
        "f1": 0.9916174822235455,
        "iou": 0.9833743294262212,
        "dice": 0.9916174822235455,
        "specificity": 0.9501239864299514
      },
      {
        "class_id": 1,
        "class_name": "bent",
        "support": 3334,
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "iou": 0.0,
        "dice": 0.0,
        "specificity": 1.0
      },
      {
        "class_id": 2,
        "class_name": "color",
        "support": 2870,
        "precision": 0.851310861423221,
        "recall": 0.7919860627177701,
        "f1": 0.8205776173285199,
        "iou": 0.6957453321089685,
        "dice": 0.8205776173285199,
        "specificity": 0.9993186327344624
      },
      {
        "class_id": 3,
        "class_name": "flip",
        "support": 112894,
        "precision": 0.9999291420878283,
        "recall": 1.0,
        "f1": 0.9999645697886587,
        "iou": 0.9999291420878283,
        "dice": 0.9999645697886588,
        "specificity": 0.9999830733684844
      },
      {
        "class_id": 4,
        "class_name": "scratch",
        "support": 12368,
        "precision": 0.8258287028166316,
        "recall": 0.6969598965071151,
        "f1": 0.7559414189248443,
        "iou": 0.6076413365289722,
        "dice": 0.7559414189248443,
        "specificity": 0.9968280776196276
      }
    ],
    "image_level_any_defect": {
      "num_images": 21,
      "tp": 16,
      "fp": 0,
      "fn": 1,
      "tn": 4,
      "accuracy": 0.9523809523809523,
      "precision": 1.0,
      "recall": 0.9411764705882353,
      "f1": 0.9696969696969697
    },
    "confusion_matrix": [
      [
        452955,
        0,
        202,
        8,
        891
      ],
      [
        2586,
        0,
        177,
        0,
        571
      ],
      [
        241,
        0,
        2273,
        0,
        356
      ],
      [
        0,
        0,
        0,
        112894,
        0
      ],
      [
        3730,
        0,
        18,
        0,
        8620
      ]
    ],
    "confusion_matrix_normalized_by_true": [
      [
        0.9975751889634759,
        0.0,
        0.0004448790457564706,
        1.761897210916715e-05,
        0.0019623130186584917
      ],
      [
        0.7756448710257948,
        0.0,
        0.053089382123575286,
        0.0,
        0.17126574685062987
      ],
      [
        0.08397212543554007,
        0.0,
        0.7919860627177701,
        0.0,
        0.1240418118466899
      ],
      [
        0.0,
        0.0,
        0.0,
        1.0,
        0.0
      ],
      [
        0.30158473479948256,
        0.0,
        0.0014553686934023287,
        0.0,
        0.6969598965071151
      ]
    ],
    "total_pixels": 585522
  }
}