{
  "split": "val",
  "weights_path": "models\\best_unet_metalnut_multiclass_bentfix256.pth",
  "data_dir": "data\\processed\\metal_nut",
  "image_size": 256,
  "device": "cpu",
  "all_pixels": {
    "summary": {
      "pixel_accuracy": 0.9881039574032738,
      "mean_iou_all": 0.7318865499447073,
      "mean_iou_no_background": 0.6676989369312036,
      "macro_f1_no_background": 0.7822474071804942,
      "macro_precision_no_background": 0.7457380802589435,
      "macro_recall_no_background": 0.8270234388213764,
      "defect_binary_precision": 0.9301438233889014,
      "defect_binary_recall": 0.9811424593044459,
      "defect_binary_f1": 0.9549627459268988,
      "defect_binary_iou": 0.9138073711773134,
      "defect_binary_dice": 0.9549627459268988
    },
    "per_class": [
      {
        "class_id": 0,
        "class_name": "background",
        "support": 1225441,
        "precision": 0.9976634362275832,
        "recall": 0.9909314279512437,
        "f1": 0.9942860371249969,
        "iou": 0.9886370019987218,
        "dice": 0.9942860371249969,
        "specificity": 0.9811424593044459
      },
      {
        "class_id": 1,
        "class_name": "bent",
        "support": 5920,
        "precision": 0.47916152897657216,
        "recall": 0.6564189189189189,
        "f1": 0.5539558089807556,
        "iou": 0.38308359621451105,
        "dice": 0.5539558089807555,
        "specificity": 0.9969175443103006
      },
      {
        "class_id": 2,
        "class_name": "color",
        "support": 5606,
        "precision": 0.7456535737282679,
        "recall": 0.8262575811630396,
        "f1": 0.7838889829074294,
        "iou": 0.6445866963540217,
        "dice": 0.7838889829074294,
        "specificity": 0.9988472622478386
      },
      {
        "class_id": 3,
        "class_name": "flip",
        "support": 126736,
        "precision": 0.9614567204056229,
        "recall": 0.999479232420149,
        "f1": 0.9800993485089986,
        "iou": 0.960975313699607,
        "dice": 0.9800993485089986,
        "specificity": 0.9959360394391447
      },
      {
        "class_id": 4,
        "class_name": "scratch",
        "support": 12553,
        "precision": 0.7966804979253111,
        "recall": 0.8259380227833983,
        "f1": 0.8110454883247936,
        "iou": 0.6821501414566747,
        "dice": 0.8110454883247937,
        "specificity": 0.9980596948162467
      }
    ],
    "image_level_any_defect": {
      "num_images": 21,
      "tp": 17,
      "fp": 0,
      "fn": 0,
      "tn": 4,
      "accuracy": 1.0,
      "precision": 1.0,
      "recall": 1.0,
      "f1": 1.0
    },
    "confusion_matrix": [
      [
        1214328,
        2740,
        793,
        5078,
        2502
      ],
      [
        1211,
        3886,
        774,
        0,
        49
      ],
      [
        263,
        616,
        4632,
        0,
        95
      ],
      [
        66,
        0,
        0,
        126670,
        0
      ],
      [
        1304,
        868,
        13,
        0,
        10368
      ]
    ],
    "confusion_matrix_normalized_by_true": [
      [
        0.9909314279512437,
        0.002235929759164252,
        0.0006471139777435226,
        0.004143814349283238,
        0.002041713962565313
      ],
      [
        0.20456081081081082,
        0.6564189189189189,
        0.13074324324324324,
        0.0,
        0.008277027027027027
      ],
      [
        0.04691402069211559,
        0.10988226899750267,
        0.8262575811630396,
        0.0,
        0.016946129147342132
      ],
      [
        0.000520767579851029,
        0.0,
        0.0,
        0.999479232420149,
        0.0
      ],
      [
        0.10387955070501076,
        0.06914681749382617,
        0.0010356090177646778,
        0.0,
        0.8259380227833983
      ]
    ],
    "total_pixels": 1376256
  },
  "nut_pixels_only": {
    "summary": {
      "pixel_accuracy": 0.9863762591328763,
      "mean_iou_all": 0.7682228678072431,
      "mean_iou_no_background": 0.7140120139674925,
      "macro_f1_no_background": 0.8131351458012304,
      "macro_precision_no_background": 0.781111093295105,
      "macro_recall_no_background": 0.8620157536555263,
      "defect_binary_precision": 0.9648077439369985,
      "defect_binary_recall": 0.9840795338718756,
      "defect_binary_f1": 0.9743483532787565,
      "defect_binary_iou": 0.9499798068803466,
      "defect_binary_dice": 0.9743483532787565
    },
    "per_class": [
      {
        "class_id": 0,
        "class_name": "background",
        "support": 454056,
        "precision": 0.9953636222670181,
        "recall": 0.9896070088271051,
        "f1": 0.9924769681695795,
        "iou": 0.9850662831662461,
        "dice": 0.9924769681695796,
        "specificity": 0.9840795338718756
      },
      {
        "class_id": 1,
        "class_name": "bent",
        "support": 3334,
        "precision": 0.4552694943508057,
        "recall": 0.737252549490102,
        "f1": 0.5629222489407993,
        "iou": 0.39171314741035856,
        "dice": 0.5629222489407992,
        "specificity": 0.9949483671941023
      },
      {
        "class_id": 2,
        "class_name": "color",
        "support": 2870,
        "precision": 0.8669661368348307,
        "recall": 0.8742160278745644,
        "f1": 0.8705759888965996,
        "iou": 0.7708141321044547,
        "dice": 0.8705759888965996,
        "specificity": 0.9993392282185593
      },
      {
        "class_id": 3,
        "class_name": "flip",
        "support": 112894,
        "precision": 0.9999291420878283,
        "recall": 1.0,
        "f1": 0.9999645697886587,
        "iou": 0.9999291420878283,
        "dice": 0.9999645697886588,
        "specificity": 0.9999830733684844
      },
      {
        "class_id": 4,
        "class_name": "scratch",
        "support": 12368,
        "precision": 0.8022795999069551,
        "recall": 0.8365944372574385,
        "f1": 0.819077775578864,
        "iou": 0.6935916342673281,
        "dice": 0.8190777755788641,
        "specificity": 0.9955509339549231
      }
    ],
    "image_level_any_defect": {
      "num_images": 21,
      "tp": 17,
      "fp": 0,
      "fn": 0,
      "tn": 4,
      "accuracy": 1.0,
      "precision": 1.0,
      "recall": 1.0,
      "f1": 1.0
    },
    "confusion_matrix": [
      [
        449337,
        1855,
        367,
        8,
        2489
      ],
      [
        822,
        2458,
        5,
        0,
        49
      ],
      [
        127,
        222,
        2509,
        0,
        12
      ],
      [
        0,
        0,
        0,
        112894,
        0
      ],
      [
        1144,
        864,
        13,
        0,
        10347
      ]
    ],
    "confusion_matrix_normalized_by_true": [
      [
        0.9896070088271051,
        0.004085399157813133,
        0.0008082703455080431,
        1.761897210916715e-05,
        0.00548170269746463
      ],
      [
        0.2465506898620276,
        0.737252549490102,
        0.0014997000599880025,
        0.0,
        0.014697060587882423
      ],
      [
        0.04425087108013937,
        0.07735191637630662,
        0.8742160278745644,
        0.0,
        0.004181184668989547
      ],
      [
        0.0,
        0.0,
        0.0,
        1.0,
        0.0
      ],
      [
        0.09249676584734799,
        0.06985769728331177,
        0.0010510996119016817,
        0.0,
        0.8365944372574385
      ]
    ],
    "total_pixels": 585522
  }
}