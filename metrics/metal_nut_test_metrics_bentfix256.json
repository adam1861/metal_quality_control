{
  "split": "test",
  "weights_path": "models\\best_unet_metalnut_multiclass_bentfix256.pth",
  "data_dir": "data\\processed\\metal_nut",
  "image_size": 256,
  "device": "cpu",
  "all_pixels": {
    "summary": {
      "pixel_accuracy": 0.9822749385127315,
      "mean_iou_all": 0.6957277623463243,
      "mean_iou_no_background": 0.6241455906849562,
      "macro_f1_no_background": 0.7476741067168784,
      "macro_precision_no_background": 0.7055051458443825,
      "macro_recall_no_background": 0.8078251365699658,
      "defect_binary_precision": 0.9138188749080614,
      "defect_binary_recall": 0.9754750909658846,
      "defect_binary_f1": 0.9436409221949088,
      "defect_binary_iou": 0.8932956056529672,
      "defect_binary_dice": 0.9436409221949088
    },
    "per_class": [
      {
        "class_id": 0,
        "class_name": "background",
        "support": 1532570,
        "precision": 0.9961690270119862,
        "recall": 0.9857794423745734,
        "f1": 0.9909470030395297,
        "iou": 0.9820564489917966,
        "dice": 0.9909470030395297,
        "specificity": 0.9754750909658846
      },
      {
        "class_id": 1,
        "class_name": "bent",
        "support": 7355,
        "precision": 0.45865230924539413,
        "recall": 0.7412644459551325,
        "f1": 0.5666770605966116,
        "iou": 0.39535895576504715,
        "dice": 0.5666770605966116,
        "specificity": 0.9963481426034707
      },
      {
        "class_id": 2,
        "class_name": "color",
        "support": 6809,
        "precision": 0.6461200585651538,
        "recall": 0.6481127918930827,
        "f1": 0.6471148911210499,
        "iou": 0.47832213310210275,
        "dice": 0.6471148911210499,
        "specificity": 0.9986287792958722
      },
      {
        "class_id": 3,
        "class_name": "flip",
        "support": 189964,
        "precision": 0.9603818156985537,
        "recall": 0.9994262070708134,
        "f1": 0.9795150792852334,
        "iou": 0.9598525753806952,
        "dice": 0.9795150792852334,
        "specificity": 0.995041493933554
      },
      {
        "class_id": 4,
        "class_name": "scratch",
        "support": 32774,
        "precision": 0.7568663998684283,
        "recall": 0.8424971013608348,
        "f1": 0.7973893958646183,
        "iou": 0.6630486984919797,
        "dice": 0.7973893958646182,
        "specificity": 0.9948926065441429
      }
    ],
    "image_level_any_defect": {
      "num_images": 27,
      "tp": 21,
      "fp": 0,
      "fn": 1,
      "tn": 5,
      "accuracy": 0.9629629629629629,
      "precision": 1.0,
      "recall": 0.9545454545454546,
      "f1": 0.9767441860465117
    },
    "confusion_matrix": [
      [
        1510776,
        4530,
        571,
        7832,
        8861
      ],
      [
        634,
        5452,
        1262,
        0,
        7
      ],
      [
        1445,
        949,
        4413,
        0,
        2
      ],
      [
        109,
        0,
        0,
        189855,
        0
      ],
      [
        3622,
        956,
        584,
        0,
        27612
      ]
    ],
    "confusion_matrix_normalized_by_true": [
      [
        0.9857794423745734,
        0.0029558193100478283,
        0.00037257678278969315,
        0.005110370162537437,
        0.005781791370051612
      ],
      [
        0.08619986403806934,
        0.7412644459551325,
        0.1715839564921822,
        0.0,
        0.0009517335146159076
      ],
      [
        0.21221912175062418,
        0.139374357468057,
        0.6481127918930827,
        0.0,
        0.000293728888236158
      ],
      [
        0.0005737929291865828,
        0.0,
        0.0,
        0.9994262070708134,
        0.0
      ],
      [
        0.11051443217184354,
        0.029169463599194482,
        0.017819002868127175,
        0.0,
        0.8424971013608348
      ]
    ],
    "total_pixels": 1769472
  },
  "nut_pixels_only": {
    "summary": {
      "pixel_accuracy": 0.976768898791889,
      "mean_iou_all": 0.6919966404534328,
      "mean_iou_no_background": 0.6224707308965842,
      "macro_f1_no_background": 0.7395078057048472,
      "macro_precision_no_background": 0.7423422046894581,
      "macro_recall_no_background": 0.7999755137175653,
      "defect_binary_precision": 0.9453117534911022,
      "defect_binary_recall": 0.9777441018810916,
      "defect_binary_f1": 0.9612544418122594,
      "defect_binary_iou": 0.925399328291062,
      "defect_binary_dice": 0.9612544418122594
    },
    "per_class": [
      {
        "class_id": 0,
        "class_name": "background",
        "support": 555410,
        "precision": 0.9913723272276144,
        "recall": 0.9783601303541528,
        "f1": 0.9848232490281189,
        "iou": 0.9701002786808275,
        "dice": 0.9848232490281189,
        "specificity": 0.9777441018810916
      },
      {
        "class_id": 1,
        "class_name": "bent",
        "support": 3806,
        "precision": 0.46815627508696817,
        "recall": 0.91933788754598,
        "f1": 0.6203900709219858,
        "iou": 0.4496851304459581,
        "dice": 0.6203900709219858,
        "specificity": 0.9947977128258955
      },
      {
        "class_id": 2,
        "class_name": "color",
        "support": 2611,
        "precision": 0.7424772568229531,
        "recall": 0.40635771734967446,
        "f1": 0.5252475247524753,
        "iou": 0.35615978516280633,
        "dice": 0.5252475247524753,
        "specificity": 0.9995191315096918
      },
      {
        "class_id": 3,
        "class_name": "flip",
        "support": 174562,
        "precision": 0.9999255334383503,
        "recall": 1.0,
        "f1": 0.9999627653328064,
        "iou": 0.9999255334383503,
        "dice": 0.9999627653328064,
        "specificity": 0.9999780898014767
      },
      {
        "class_id": 4,
        "class_name": "scratch",
        "support": 31504,
        "precision": 0.7588097534095606,
        "recall": 0.8742064499746064,
        "f1": 0.8124308618121211,
        "iou": 0.684112474539222,
        "dice": 0.8124308618121211,
        "specificity": 0.9881122613184065
      }
    ],
    "image_level_any_defect": {
      "num_images": 27,
      "tp": 21,
      "fp": 0,
      "fn": 1,
      "tn": 5,
      "accuracy": 0.9629629629629629,
      "precision": 1.0,
      "recall": 0.9545454545454546,
      "f1": 0.9767441860465117
    },
    "confusion_matrix": [
      [
        543391,
        3039,
        215,
        13,
        8752
      ],
      [
        304,
        3499,
        3,
        0,
        0
      ],
      [
        1007,
        541,
        1061,
        0,
        2
      ],
      [
        0,
        0,
        0,
        174562,
        0
      ],
      [
        3418,
        395,
        150,
        0,
        27541
      ]
    ],
    "confusion_matrix_normalized_by_true": [
      [
        0.9783601303541528,
        0.005471633567994814,
        0.0003871014205721899,
        2.3406132406690554e-05,
        0.01575772852487352
      ],
      [
        0.07987388334209143,
        0.91933788754598,
        0.0007882291119285339,
        0.0,
        0.0
      ],
      [
        0.38567598621217924,
        0.20720030639601686,
        0.40635771734967446,
        0.0,
        0.0007659900421294523
      ],
      [
        0.0,
        0.0,
        0.0,
        1.0,
        0.0
      ],
      [
        0.10849415947181311,
        0.012538090401218893,
        0.004761300152361605,
        0.0,
        0.8742064499746064
      ]
    ],
    "total_pixels": 767893
  }
}