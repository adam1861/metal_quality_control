{
  "split": "test",
  "weights_path": "models\\best_unet_metalnut_multiclass.pth",
  "data_dir": "data\\processed\\metal_nut",
  "image_size": 256,
  "device": "cpu",
  "all_pixels": {
    "summary": {
      "pixel_accuracy": 0.9845569751880787,
      "mean_iou_all": 0.5889945995591461,
      "mean_iou_no_background": 0.48973585173482337,
      "macro_f1_no_background": 0.5722103957312799,
      "macro_precision_no_background": 0.5728471305725611,
      "macro_recall_no_background": 0.5809306887941708,
      "defect_binary_precision": 0.9721422931836126,
      "defect_binary_recall": 0.9355303036698719,
      "defect_binary_f1": 0.9534849703795802,
      "defect_binary_iou": 0.9111048990146062,
      "defect_binary_dice": 0.9534849703795802
    },
    "per_class": [
      {
        "class_id": 0,
        "class_name": "background",
        "support": 1532570,
        "precision": 0.9900920666471185,
        "recall": 0.9958559804772376,
        "f1": 0.992965659118131,
        "iou": 0.986029590856437,
        "dice": 0.992965659118131,
        "specificity": 0.9355303036698719
      },
      {
        "class_id": 1,
        "class_name": "bent",
        "support": 7355,
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "iou": 0.0,
        "dice": 0.0,
        "specificity": 1.0
      },
      {
        "class_id": 2,
        "class_name": "color",
        "support": 6809,
        "precision": 0.4792349726775956,
        "recall": 0.6440005874577764,
        "f1": 0.5495331787705996,
        "iou": 0.3788664247451184,
        "dice": 0.5495331787705997,
        "specificity": 0.997296703907667
      },
      {
        "class_id": 3,
        "class_name": "flip",
        "support": 189964,
        "precision": 0.9867164062296194,
        "recall": 0.9955517887599755,
        "f1": 0.9911144069240021,
        "iou": 0.9823853306321749,
        "dice": 0.9911144069240021,
        "specificity": 0.9983881056632825
      },
      {
        "class_id": 4,
        "class_name": "scratch",
        "support": 32774,
        "precision": 0.8254371433830296,
        "recall": 0.6841703789589308,
        "f1": 0.7481939972305176,
        "iou": 0.5976916515620002,
        "dice": 0.7481939972305177,
        "specificity": 0.9972695310295745
      }
    ],
    "image_level_any_defect": {
      "num_images": 27,
      "tp": 21,
      "fp": 0,
      "fn": 1,
      "tn": 5,
      "accuracy": 0.9629629629629629,
      "precision": 1.0,
      "recall": 0.9545454545454546,
      "f1": 0.9767441860465117
    },
    "confusion_matrix": [
      [
        1526219,
        0,
        559,
        2546,
        3246
      ],
      [
        2670,
        0,
        3448,
        0,
        1237
      ],
      [
        2165,
        0,
        4385,
        0,
        259
      ],
      [
        845,
        0,
        0,
        189119,
        0
      ],
      [
        9593,
        0,
        758,
        0,
        22423
      ]
    ],
    "confusion_matrix_normalized_by_true": [
      [
        0.9958559804772376,
        0.0,
        0.0003647467978624141,
        0.001661261802071031,
        0.0021180109228289734
      ],
      [
        0.36301835486063905,
        0.0,
        0.4687967369136642,
        0.0,
        0.16818490822569682
      ],
      [
        0.31796152151564105,
        0.0,
        0.6440005874577764,
        0.0,
        0.03803789102658246
      ],
      [
        0.004448211240024425,
        0.0,
        0.0,
        0.9955517887599755,
        0.0
      ],
      [
        0.2927015317019589,
        0.0,
        0.02312808933911027,
        0.0,
        0.6841703789589308
      ]
    ],
    "total_pixels": 1769472
  },
  "nut_pixels_only": {
    "summary": {
      "pixel_accuracy": 0.9763391514182315,
      "mean_iou_all": 0.5643425888609876,
      "mean_iou_no_background": 0.4624030905044857,
      "macro_f1_no_background": 0.5347769307270789,
      "macro_precision_no_background": 0.5593639922648695,
      "macro_recall_no_background": 0.5138919274705853,
      "defect_binary_precision": 0.9836581694394978,
      "defect_binary_recall": 0.9410635203757477,
      "defect_binary_f1": 0.9618895289406275,
      "defect_binary_iou": 0.9265772340770603,
      "defect_binary_dice": 0.9618895289406275
    },
    "per_class": [
      {
        "class_id": 0,
        "class_name": "background",
        "support": 555410,
        "precision": 0.9778201274860037,
        "recall": 0.9940188329342288,
        "f1": 0.9858529438287318,
        "iou": 0.9721005822869951,
        "dice": 0.9858529438287318,
        "specificity": 0.9410635203757477
      },
      {
        "class_id": 1,
        "class_name": "bent",
        "support": 3806,
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "iou": 0.0,
        "dice": 0.0,
        "specificity": 1.0
      },
      {
        "class_id": 2,
        "class_name": "color",
        "support": 2611,
        "precision": 0.39826839826839827,
        "recall": 0.35235541937954806,
        "f1": 0.37390774232879503,
        "iou": 0.22994251437140714,
        "dice": 0.373907742328795,
        "specificity": 0.9981836760828035
      },
      {
        "class_id": 3,
        "class_name": "flip",
        "support": 174562,
        "precision": 0.9999255334383503,
        "recall": 1.0,
        "f1": 0.9999627653328064,
        "iou": 0.9999255334383503,
        "dice": 0.9999627653328064,
        "specificity": 0.9999780898014767
      },
      {
        "class_id": 4,
        "class_name": "scratch",
        "support": 31504,
        "precision": 0.8392620373527295,
        "recall": 0.7032122905027933,
        "f1": 0.7652372152467143,
        "iou": 0.6197443142081853,
        "dice": 0.7652372152467142,
        "specificity": 0.9942380997000226
      }
    ],
    "image_level_any_defect": {
      "num_images": 27,
      "tp": 20,
      "fp": 0,
      "fn": 2,
      "tn": 5,
      "accuracy": 0.9259259259259259,
      "precision": 1.0,
      "recall": 0.9090909090909091,
      "f1": 0.9523809523809523
    },
    "confusion_matrix": [
      [
        552088,
        0,
        170,
        13,
        3139
      ],
      [
        1704,
        0,
        1213,
        0,
        889
      ],
      [
        1476,
        0,
        920,
        0,
        215
      ],
      [
        0,
        0,
        0,
        174562,
        0
      ],
      [
        9343,
        0,
        7,
        0,
        22154
      ]
    ],
    "confusion_matrix_normalized_by_true": [
      [
        0.9940188329342288,
        0.0,
        0.00030608019301056876,
        2.3406132406690554e-05,
        0.005651680740353973
      ],
      [
        0.44771413557540723,
        0.0,
        0.31870730425643723,
        0.0,
        0.23357856016815554
      ],
      [
        0.5653006510915358,
        0.0,
        0.35235541937954806,
        0.0,
        0.08234392952891613
      ],
      [
        0.0,
        0.0,
        0.0,
        1.0,
        0.0
      ],
      [
        0.2965655154900965,
        0.0,
        0.00022219400711020822,
        0.0,
        0.7032122905027933
      ]
    ],
    "total_pixels": 767893
  }
}